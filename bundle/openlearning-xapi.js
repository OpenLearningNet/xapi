(()=>{"use strict";var e,t={607:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveActivityState=t.saveActivityState=t.saveFailed=t.savePassed=t.saveCompletion=t.saveAttachments=t.initLrs=void 0;var r=i(260);Object.defineProperty(t,"initLrs",{enumerable:!0,get:function(){return r.initLrs}});var n=i(12);Object.defineProperty(t,"saveAttachments",{enumerable:!0,get:function(){return n.saveAttachments}});var a=i(988);Object.defineProperty(t,"saveCompletion",{enumerable:!0,get:function(){return a.saveCompletion}});var s=i(248);Object.defineProperty(t,"savePassed",{enumerable:!0,get:function(){return s.savePassed}}),Object.defineProperty(t,"saveFailed",{enumerable:!0,get:function(){return s.saveFailed}});var o=i(774);Object.defineProperty(t,"saveActivityState",{enumerable:!0,get:function(){return o.saveActivityState}}),Object.defineProperty(t,"retrieveActivityState",{enumerable:!0,get:function(){return o.retrieveActivityState}})},651:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Lrs=t.VERSION=void 0,t.VERSION="1.0.2",t.Lrs=class{constructor(e){this.endpoint=e.endpoint,"/"!==this.endpoint.slice(-1)&&(this.endpoint+="/"),this.auth=e.auth}saveStatement(e){const i=this.endpoint+"statements",r=new Headers;return r.set("Content-Type","application/json"),r.set("Authorization",this.auth),r.set("X-Experience-API-Version",t.VERSION),fetch(i,{method:"PUT",headers:r,credentials:"include",mode:"cors",body:JSON.stringify(e)})}saveActivityState(e,i,r,n){const a=new URL(this.endpoint+"activities/state");a.searchParams.set("activityId",e),a.searchParams.set("stateId",i),a.searchParams.set("agent",JSON.stringify(r));const s=new Headers;return s.set("Content-Type","application/json"),s.set("Authorization",this.auth),s.set("X-Experience-API-Version",t.VERSION),fetch(a.toString(),{method:"POST",headers:s,credentials:"include",mode:"cors",body:JSON.stringify(n)})}retrieveActivityState(e,i,r){const n=new URL(this.endpoint+"activities/state");n.searchParams.set("activityId",e),n.searchParams.set("stateId",i),n.searchParams.set("agent",JSON.stringify(r));const a=new Headers;return a.set("Authorization",this.auth),a.set("X-Experience-API-Version",t.VERSION),fetch(n.toString(),{method:"GET",headers:a,credentials:"include",mode:"cors"})}}},774:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveActivityState=t.saveActivityState=void 0,t.saveActivityState=(e,t,i)=>e?e.lrs.saveActivityState(e.activity_id,t,e.actor,i).then((e=>200===e.status)):Promise.reject({error:"No LRS configured in the URL.",xhr:null}),t.retrieveActivityState=(e,t,i)=>e?e.lrs.retrieveActivityState(e.activity_id,t,e.actor).then((e=>void 0!==i&&404===e.status?Promise.resolve(i):200!==e.status?Promise.reject(e):e.json())):Promise.reject({error:"No LRS configured in the URL.",xhr:null})},12:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveAttachments=t.buildStatement=t.convertMediaToAttachment=void 0,t.convertMediaToAttachment=({contentType:e,fileUrl:t,display:i,description:r})=>("string"==typeof i&&(i={"en-US":i}),"string"==typeof r&&(r={"en-US":r}),{contentType:e,usageType:"http://id.tincanapi.com/attachment/supporting_media",display:i,description:r,fileUrl:t}),t.buildStatement=(e,t,i)=>({actor:e.actor,object:{id:e.activity_id,objectType:"Activity"},context:{registration:e.registration},verb:{id:"https://xapi.openlearning.com/verbs/"+i,display:{"en-US":i}},attachments:t}),t.saveAttachments=(e,i,r="published",n)=>{if(!e)return Promise.reject({error:"No LRS configured in the URL.",xhr:null});const a=i.map(t.convertMediaToAttachment);n&&a.unshift({contentType:"image/png",usageType:"https://xapi.openlearning.com/attachment/thumbnail",fileUrl:n,display:{"en-US":"Thumbnail Image"},description:{"en-US":"Thumbnail Image"}});const s=e.lrs,o=(0,t.buildStatement)(e,a,r);return s.saveStatement(o)}},988:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveCompletion=void 0,t.saveCompletion=(e,t)=>{if(!e)return Promise.reject({error:"No LRS configured in the URL.",xhr:null});const i=e.lrs,r=((e,t)=>{const i={};return t&&(i["https://xapi.openlearning.com/extensions/submission-data"]=t),{actor:e.actor,object:{id:e.activity_id,objectType:"Activity"},context:{registration:e.registration},verb:{id:"http://adlnet.gov/expapi/verbs/completed",display:{"de-DE":"beendete","en-US":"completed","fr-FR":"a terminé","es-ES":"completó"}},result:{completion:!0,extensions:i}}})(e,t);return i.saveStatement(r)}},260:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initLrs=void 0;const r=i(651);t.initLrs=()=>{const e=new URLSearchParams(window.location.search),t=e.get("endpoint"),i=e.get("auth"),n=e.get("actor"),a=JSON.parse(n||"{}"),s=e.get("activity_id"),o=e.get("registration");return t?{lrs:new r.Lrs({endpoint:t,auth:i||""}),actor:a,activity_id:s,registration:o}:null}},248:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveFailed=t.savePassed=void 0;const i=(e,t,i)=>{const r={};i&&(r.score=i);const n=t?"passed":"failed";return{actor:e.actor,object:{id:e.activity_id,objectType:"Activity"},context:{registration:e.registration},verb:{id:"http://adlnet.gov/expapi/verbs/"+n,display:{"en-US":n}},result:r}};t.savePassed=(e,t)=>{if(!e)return Promise.reject({error:"No LRS configured in the URL.",xhr:null});const r=e.lrs,n=i(e,!0,t);return r.saveStatement(n)},t.saveFailed=(e,t)=>{if(!e)return Promise.reject({error:"No LRS configured in the URL.",xhr:null});const r=e.lrs,n=i(e,!1,t);return r.saveStatement(n)}}},i={};e=function e(r){var n=i[r];if(void 0!==n)return n.exports;var a=i[r]={exports:{}};return t[r](a,a.exports,e),a.exports}(607),window.xApi=e})();