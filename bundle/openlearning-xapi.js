(()=>{"use strict";var e,t={607:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveActivityState=t.saveActivityState=t.saveCompletion=t.saveAttachments=t.initLrs=void 0;var r=i(260);Object.defineProperty(t,"initLrs",{enumerable:!0,get:function(){return r.initLrs}});var n=i(12);Object.defineProperty(t,"saveAttachments",{enumerable:!0,get:function(){return n.saveAttachments}});var s=i(988);Object.defineProperty(t,"saveCompletion",{enumerable:!0,get:function(){return s.saveCompletion}});var a=i(774);Object.defineProperty(t,"saveActivityState",{enumerable:!0,get:function(){return a.saveActivityState}}),Object.defineProperty(t,"retrieveActivityState",{enumerable:!0,get:function(){return a.retrieveActivityState}})},651:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Lrs=t.VERSION=void 0,t.VERSION="1.0.2",t.Lrs=class{constructor(e){this.endpoint=e.endpoint,"/"!==this.endpoint.slice(-1)&&(this.endpoint+="/"),this.auth=e.auth}saveStatement(e){const i=this.endpoint+"statements",r=new Headers;return r.set("Content-Type","application/json"),r.set("Authorization",this.auth),r.set("X-Experience-API-Version",t.VERSION),fetch(i,{method:"PUT",headers:r,credentials:"include",mode:"cors",body:JSON.stringify(e)})}saveActivityState(e,i,r,n){const s=new URL(this.endpoint+"activities/state");s.searchParams.set("activityId",e),s.searchParams.set("stateId",i),s.searchParams.set("agent",JSON.stringify(r));const a=new Headers;return a.set("Content-Type","application/json"),a.set("Authorization",this.auth),a.set("X-Experience-API-Version",t.VERSION),fetch(s.toString(),{method:"POST",headers:a,credentials:"include",mode:"cors",body:JSON.stringify(n)})}retrieveActivityState(e,i,r){const n=new URL(this.endpoint+"activities/state");n.searchParams.set("activityId",e),n.searchParams.set("stateId",i),n.searchParams.set("agent",JSON.stringify(r));const s=new Headers;return s.set("Authorization",this.auth),s.set("X-Experience-API-Version",t.VERSION),fetch(n.toString(),{method:"GET",headers:s,credentials:"include",mode:"cors"})}}},774:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveActivityState=t.saveActivityState=void 0,t.saveActivityState=(e,t,i)=>e?e.lrs.saveActivityState(e.activity_id,t,e.actor,i).then((e=>200===e.status)):Promise.reject({error:"No LRS configured in the URL.",xhr:null}),t.retrieveActivityState=(e,t,i=!1)=>e?e.lrs.retrieveActivityState(e.activity_id,t,e.actor).then((e=>i&&404===e.status?Promise.resolve(null):200!==e.status?Promise.reject(e):e.json())):Promise.reject({error:"No LRS configured in the URL.",xhr:null})},12:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveAttachments=t.buildStatement=t.convertMediaToAttachment=void 0,t.convertMediaToAttachment=({contentType:e,fileUrl:t,display:i,description:r})=>("string"==typeof i&&(i={"en-US":i}),"string"==typeof r&&(r={"en-US":r}),{contentType:e,usageType:"http://id.tincanapi.com/attachment/supporting_media",display:i,description:r,fileUrl:t}),t.buildStatement=(e,t,i)=>({actor:e.actor,object:{id:e.activity_id,objectType:"Activity"},context:{registration:e.registration},verb:{id:"https://xapi.openlearning.com/verbs/"+i,display:{"en-US":i}},attachments:t}),t.saveAttachments=(e,i,r="published")=>{if(!e)return Promise.reject({error:"No LRS configured in the URL.",xhr:null});const n=i.map(t.convertMediaToAttachment),s=e.lrs,a=t.buildStatement(e,n,r);return s.saveStatement(a)}},988:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveCompletion=void 0,t.saveCompletion=(e,t)=>{if(!e)return Promise.reject({error:"No LRS configured in the URL.",xhr:null});const i=e.lrs,r=((e,t)=>{const i={};return t&&(i["https://xapi.openlearning.com/extensions/submission-data"]=t),{actor:e.actor,object:{id:e.activity_id,objectType:"Activity"},context:{registration:e.registration},verb:{id:"http://adlnet.gov/expapi/verbs/completed",display:{"de-DE":"beendete","en-US":"completed","fr-FR":"a terminé","es-ES":"completó"}},result:{completion:!0,extensions:i}}})(e,t);return i.saveStatement(r)}},260:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initLrs=void 0;const r=i(651);t.initLrs=()=>{const e=new URLSearchParams(window.location.search),t=e.get("endpoint"),i=e.get("auth"),n=e.get("actor"),s=JSON.parse(n||"{}"),a=e.get("activity_id"),o=e.get("registration");return t?{lrs:new r.Lrs({endpoint:t,auth:i||""}),actor:s,activity_id:a,registration:o}:null}}},i={};e=function e(r){var n=i[r];if(void 0!==n)return n.exports;var s=i[r]={exports:{}};return t[r](s,s.exports,e),s.exports}(607),window.xApi=e})();