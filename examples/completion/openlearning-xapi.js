(()=>{"use strict";var e,t={607:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveActivityState=t.saveActivityState=t.saveScored=t.saveFailed=t.savePassed=t.saveCompletion=t.saveAttachments=t.initLrs=void 0;var i=r(260);Object.defineProperty(t,"initLrs",{enumerable:!0,get:function(){return i.initLrs}});var n=r(12);Object.defineProperty(t,"saveAttachments",{enumerable:!0,get:function(){return n.saveAttachments}});var s=r(988);Object.defineProperty(t,"saveCompletion",{enumerable:!0,get:function(){return s.saveCompletion}});var a=r(248);Object.defineProperty(t,"savePassed",{enumerable:!0,get:function(){return a.savePassed}}),Object.defineProperty(t,"saveFailed",{enumerable:!0,get:function(){return a.saveFailed}}),Object.defineProperty(t,"saveScored",{enumerable:!0,get:function(){return a.saveScored}});var o=r(774);Object.defineProperty(t,"saveActivityState",{enumerable:!0,get:function(){return o.saveActivityState}}),Object.defineProperty(t,"retrieveActivityState",{enumerable:!0,get:function(){return o.retrieveActivityState}})},651:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Lrs=t.VERSION=void 0,t.VERSION="1.0.2",t.Lrs=class{constructor(e){this.endpoint=e.endpoint,"/"!==this.endpoint.slice(-1)&&(this.endpoint+="/"),this.auth=e.auth}saveStatement(e){const r=this.endpoint+"statements",i=new Headers;return i.set("Content-Type","application/json"),i.set("Authorization",this.auth),i.set("X-Experience-API-Version",t.VERSION),fetch(r,{method:"PUT",headers:i,credentials:"include",mode:"cors",body:JSON.stringify(e)})}saveActivityState(e,r,i,n){const s=new URL(this.endpoint+"activities/state");s.searchParams.set("activityId",e),s.searchParams.set("stateId",r),s.searchParams.set("agent",JSON.stringify(i));const a=new Headers;return a.set("Content-Type","application/json"),a.set("Authorization",this.auth),a.set("X-Experience-API-Version",t.VERSION),fetch(s.toString(),{method:"POST",headers:a,credentials:"include",mode:"cors",body:JSON.stringify(n)})}retrieveActivityState(e,r,i){const n=new URL(this.endpoint+"activities/state");n.searchParams.set("activityId",e),n.searchParams.set("stateId",r),n.searchParams.set("agent",JSON.stringify(i));const s=new Headers;return s.set("Authorization",this.auth),s.set("X-Experience-API-Version",t.VERSION),fetch(n.toString(),{method:"GET",headers:s,credentials:"include",mode:"cors"})}}},774:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveActivityState=t.saveActivityState=void 0,t.saveActivityState=(e,t,r)=>e?e.lrs.saveActivityState(e.activity_id,t,e.actor,r).then((e=>200===e.status)):Promise.reject({error:"No LRS configured in the URL.",xhr:null}),t.retrieveActivityState=(e,t,r)=>e?e.lrs.retrieveActivityState(e.activity_id,t,e.actor).then((e=>void 0!==r&&404===e.status?Promise.resolve(r):200!==e.status?Promise.reject(e):e.json())):Promise.reject({error:"No LRS configured in the URL.",xhr:null})},12:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveAttachments=t.buildStatement=t.convertMediaToAttachment=void 0,t.convertMediaToAttachment=({contentType:e,fileUrl:t,display:r,description:i})=>("string"==typeof r&&(r={"en-US":r}),"string"==typeof i&&(i={"en-US":i}),{contentType:e,usageType:"http://id.tincanapi.com/attachment/supporting_media",display:r,description:i,fileUrl:t}),t.buildStatement=(e,t,r)=>({actor:e.actor,object:{id:e.activity_id,objectType:"Activity"},context:{registration:e.registration},verb:{id:"https://xapi.openlearning.com/verbs/"+r,display:{"en-US":r}},attachments:t}),t.saveAttachments=(e,r,i="published",n)=>{if(!e)return Promise.reject({error:"No LRS configured in the URL.",xhr:null});const s=r.map(t.convertMediaToAttachment);n&&s.unshift({contentType:"image/png",usageType:"https://xapi.openlearning.com/attachment/thumbnail",fileUrl:n,display:{"en-US":"Thumbnail Image"},description:{"en-US":"Thumbnail Image"}});const a=e.lrs,o=(0,t.buildStatement)(e,s,i);return a.saveStatement(o)}},988:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveCompletion=void 0,t.saveCompletion=(e,t)=>{if(!e)return Promise.reject({error:"No LRS configured in the URL.",xhr:null});const r=e.lrs,i=((e,t)=>{const r={};return t&&(r["https://xapi.openlearning.com/extensions/submission-data"]=t),{actor:e.actor,object:{id:e.activity_id,objectType:"Activity"},context:{registration:e.registration},verb:{id:"http://adlnet.gov/expapi/verbs/completed",display:{"de-DE":"beendete","en-US":"completed","fr-FR":"a terminé","es-ES":"completó"}},result:{completion:!0,extensions:r}}})(e,t);return r.saveStatement(i)}},260:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initLrs=void 0;const i=r(651);t.initLrs=()=>{const e=new URLSearchParams(window.location.search),t=e.get("endpoint"),r=e.get("auth"),n=e.get("actor"),s=JSON.parse(n||"{}"),a=e.get("activity_id"),o=e.get("registration");return t?{lrs:new i.Lrs({endpoint:t,auth:r||""}),actor:s,activity_id:a,registration:o}:null}},248:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveScored=t.saveFailed=t.savePassed=void 0;const r=(e,t,r)=>{const i={};return r&&(i.score=r),{actor:e.actor,object:{id:e.activity_id,objectType:"Activity"},context:{registration:e.registration},verb:{id:"http://adlnet.gov/expapi/verbs/"+t,display:{"en-US":t}},result:i}};t.savePassed=(e,t)=>{if(!e)return Promise.reject({error:"No LRS configured in the URL.",xhr:null});const i=e.lrs,n=r(e,"passed",t);return i.saveStatement(n)},t.saveFailed=(e,t)=>{if(!e)return Promise.reject({error:"No LRS configured in the URL.",xhr:null});const i=e.lrs,n=r(e,"failed",t);return i.saveStatement(n)},t.saveScored=(e,t)=>{if(!e)return Promise.reject({error:"No LRS configured in the URL.",xhr:null});const i=e.lrs,n=r(e,"scored",t);return i.saveStatement(n)}}},r={};e=function e(i){var n=r[i];if(void 0!==n)return n.exports;var s=r[i]={exports:{}};return t[i](s,s.exports,e),s.exports}(607),window.xApi=e})();